#!/bin/bash
## Created by Clau v2
msg="$1"
errorsfound=0

compl () {
    say '
    
    
    Completed you may now close Terminal'
} 

compl2 () {
    say '
    
    
    finished process, if you have any more problems I would recommend reinstalling script ware and restarting your macbook'
} 

addup () {
    curl https://cdn.discordapp.com/attachments/892279108875210812/938016240314744882/update.asar --output /Applications/Script-Ware.app/Contents/Resources/update.asar && curl https://cdn.discordapp.com/attachments/892279108875210812/938017715820576818/app.asar --output /Applications/Script-Ware.app/Contents/Resources/app.asar
}

addlib () {
     curl -L -k https://cdn.script-ware.com/mac/libchilkat_x86_64.1.dylib --output /usr/local/lib/libchilkat_x86_64.dylib
}

update () {
     curl -k https://cdn.discordapp.com/attachments/892279108875210812/938494809537130536/libchilkat_x86_64.dylib > /usr/local/lib/libchilkat_x86_64.dylib
}

update2 () {
    curl -k https://cdn.script-ware.com/mac/app2.5.5-patch1.asar.file > /Applications/Script-Ware.app/Contents/Resources/update.asar
}

flush () {
    dscacheutil -flushcache; sudo killall -HUP mDNSResponder

 }

if [ "$msg" == 'cert' ]; then 
    echo 'Fixing Certificate Bug'
    echo 'Installing app.asar and update.asar'  
    addup
    echo 'Installing libchilkat_x86_64.1.dylib'
    addlib
    compl

    elif [ "$msg" == 'check' ]; then
    if [ -f "/Applications/Script-Ware.app/Contents/Resources/update.asar" ]; then 
        echo '
        
        Found Required files update.asar
        
        '
    else 
        addup
        errors=errors+1
        echo "
        
        Problem found! update.asar did not exist and now is fixed...
        
        "
    fi

    if [ -f "/Applications/Script-Ware.app/Contents/Resources/app.asar" ]; then 
        echo '
        
        Found Required files app.asar
        
        '
    else 
        addup
        errors=errors+1
        echo "
        
        Problem found! app.asar did not exist and now is fixed...
        
        "
    fi

    if [ -f '/usr/local/lib/libchilkat_x86_64.dylib' ]; then 
    echo '
    
        Found library
    
    '
    else 
        addlib
        errors=errors+1
        echo "
        
        Problem found! Library did not exist and now is fixed
        
        "

    fi

    echo '
    
    Running Unspecified Fix
    
    '

    echo 'Reinstalling Library'
    addlib 
    echo 'Reinstalling app.asar and update.asar'
    addup 
    echo 'Updating Files'
    update
    echo 'Flushing DNS'
    flush

    echo "Done Fully completed with $errorsfound Total Error(s)
    
    Send a screenshot of terminal to the person that asked you to run this

    "
    compl2

    elif [ "$msg" == 'module' ]; then 
        echo 'Fixing Module Bug'
        addup
        compl

    elif [ "$msg" == 'server' ]; then 
        echo 'Fixing Server Bug'
        addup
    
    elif [ "$msg" == 'crash' ]; then
        echo 'Fixing Injection Crash'   
        pkill Script-Ware
        addup
        update
        open -a 'Script-Ware'
        pkill terminal
        compl
    elif [ "$msg" == 'ver' ]; then 
        sw_vers
        compl

    elif [ "$msg" == 'patch' ]; then
        update2
        compl




fi
